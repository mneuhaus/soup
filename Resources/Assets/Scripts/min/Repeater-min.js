$.widget("custom.repeater",{options:{autoAdd:!0,placeholder:"--id--"},_create:function(){this.setOptionsFromAttributes();var e=this;this.itemsContainer=this.find(".repeater-items"),this.template=this.find(".repeater-template"),this.options.autoAdd===!0&&($(this.element).on("keyup",".repeater-unused input",function(){$(this).val().length>0&&($(this).parents(".repeater-unused").removeClass("repeater-unused"),e.addNewUnused())}),e.addNewUnused()),$(this.element).on("click",".repeater-item-add",function(t){t.preventDefault(),e.addNew()}),$(this.element).on("click",".repeater-item-remove",function(t){t.preventDefault();var n=$(this).parents(".repeater-item").first();e.element.append('<input type="hidden" name="'+n.find("input").attr("name")+'[_remove]" value=1>'),n.find(".repeater-item-remove").remove(),n.slideUp(function(){n.remove()})}),$("form").submit(function(){$(".repeater-unused, .repeater-template").remove()})},setOptionsFromAttributes:function(){void 0!==this.element.data("auto-add")&&(this.options.autoAdd=this.element.data("auto-add")?!0:!1),void 0!==this.element.data("placeholder")&&(this.options.placeholder=this.element.data("placeholder"))},addNewUnused:function(){var e=this.template.clone();return e.removeClass("repeater-template"),e.addClass("repeater-unused"),console.log(this.options.placeholder),e.html(e.html().replace("/"+this.options.placeholder+"/g",Math.random().toString(36).slice(2))),this.itemsContainer.append(e),e.find(".card-expandable").cardExpandable(),e.find(".repeater").repeater(),e},addNew:function(){return this.addNewUnused().removeClass("repeater-unused")},find:function(e){return this.element.find(e).not(this.element.find(".repeater "+e))}});